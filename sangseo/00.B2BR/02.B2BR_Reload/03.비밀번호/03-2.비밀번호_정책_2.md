---
tags:
  - "#패스워드_복잡성"
  - pwquality
---
```
vim /etc/security/pwquality.conf
```
![[00.born2beroot_번역#^60a1f0]]
![[00.born2beroot_번역#^9cdaee]]
![[00.born2beroot_번역#^e0f16f]]
위 두 항목을 설정할 것입니다.
***
비밀번호 최소길이 10자는 이전 페이지인 [[03-1.비밀번호_정책_1]]에서 설정하였습니다.
# 패키지 설치
![[Pasted image 20240414211349.png]]
```
apt-get install libpam-pwquality
```
일단 패스워드 복잡성을 구현하기 위해서 `패스워드퀄리티`패키지를 설치해 줍니다.
> **`pam이란?`**
> PAM은 리눅스 시스템에서 사용하는 '인증 모듈(Pluggable Authentication Modules)'로써 응용 프로그램(서비스)에 대한 사용자의 사용 권한을 제어하는 모듈이다.
***
## 설치 확인하기(생략가능)
```
vim /etc/pam.d/common-password
```
위 명령어를 통해 `common-password`파일을 확인합니다.
![[Pasted image 20240414212726.png]]
핑크색의 `pam_pwquality.so`가 생겼습니다.
여기서 옆의 `retry=3`이 적혀있는 것을 볼 수 있습니다.
재시도는 3번까지 할 수 있다라는 뜻입니다.
***
# 파일 수정하기(복잡성 구성)
```
vim /etc/security/pwquality.conf
```
위 명령어로 pwquality.conf 파일을 vim에디터로 열어줍니다.
## 옵션
pam_pwquality에 줄 수 있는 옵션은 아래를 확인합니다.
더 자세한 내용은 [man-pages](https://wariua.github.io/man-pages-ko/pwquality.conf%285%29/)를 확인합니다.
+ `difok`=num
	+ 이전 패스워드에는 없고 새 패스워드에만 있는 문자 개수.
	  (기본값은 1.)
	+ 특수값 `0`은 새 패스워드와 이전 패스워드의 유사성 검사들을 모두 끈다.
	  단, 새 패스워드가 이전 패스워드와 똑같은지는 검사한다.
+ **`dcredit`**=num
	+ 새로운 패스워드 설정 시 최대 숫자 개수를 요구하는 옵션
	+ 값이 0미만일 시, 최소 갯수를 요구하는 것이다.
+ **`ucredit`**=num
	+ 새로운 패스워드 설정 시 최대 대문자 개수를 요구하는 옵션
	+ 값이 0미만일 시, 최소 갯수를 요구하는 것이다.
+ **`lcredit`**=num
	+ 새로운 패스워드 설정 시 최대 소문자 개수를 요구하는 옵션
	+ 값이 0미만일 시, 최소 갯수를 요구하는 것이다.
+ minclass=num
	+ 새로운 패스워드 설정 시(숫자, 대문자, 소문자, 기타) 최소 종류를 요구하는 옵션이다.
+ **`maxrepeat`**=num
	+ 새로운 패스워드 설정 시 연달아 나오는 같은 문자 최대 개수를 요구하는 옵션이다.
	+ 값이 0이면 검사하지 않는다.
+ maxclassrepeat=num
	+ 새로운 패스워드 설정 시 연달아 나오는 종류의 문자 최대 개수를 요구하는 옵션이다.
	+ 값이 0이면 검사하지 않는다.
+ **`usercheck`**=N
	+ 0이 아니면 (다소 변경한) 패스워드에 사용자 이름이 어떤 형태로 포함돼 있는지 검사.
	+ 사용자 이름이 3글자보다 짧으면 수행하지 않는다.
	  (기본값은 1.)
+ **`enforce_for_root`**
	+ 패스워드를 바꾸려고 하는 사용자가 root인 경우에도 검사 실패 시 오류를 반환한다. 기본적으로 이 옵션이 꺼져 있는데, 실패한 검사에 대한 메시지는 찍지만 어쨌든 root는 패스워드를 바꿀 수 있다는 뜻이다. 참고로 root에게는 이전 패스워드를 묻지 않으므로 이전 패스워드와 새 패스워드를 비교하는 검사를 수행하지 않는다.
***
# 정책 맞춰주기
아래에 해당하는 내용들을 주석 처리하고 숫자도 맞춰준다.
difok = 7
minlen = 10
dcredit = -1
ucredit = -1
lcredit = -1
maxrepeat = 3
usercheck = 1
enforce_for_root
***
# 테스트하기
```
passwd [유저명]
```
위 명령어를 통해서 비밀번호를 바꾸기를 시도하며 조건에 충족 되었는지확인해야 한다.

Current password: [현재 비밀번호]
New password: [시도하려는 비밀번호]

아래 경고들이 발생시킬 수 있다면 성공한 것이다.
> BAD PASSWORD: The password is shorter than 10 characters
> 10자리 미만이다.
> BAS PASSWORD: The password is too similar to the old one
> 이전의 패스워드와 너무 비슷하다.
> BAD PASSWORD: The password contains the user name in some form
> 유저명이 들어갔다.
> BAD PASSWORD: The password contains less than 1 uppercase letters
> 대문자가 없다.
> BAD PASSWORD: The password contains less than 1 digits
> 소문자가 없다.
***
